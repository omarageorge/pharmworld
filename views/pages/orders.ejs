<%- include('../partials/layout_top') -%>
<section id="order-wrapper">
  <div class="container">

    <!-- Table -->
    <% if (orders.length > 0) { %>
      <table>
        <caption>Orders</caption>
        
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Date</th>
            <th>Price</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
  
        <tbody>
          <% orders.forEach((order) => { %>
            <tr class="<% if (order.paid === true) { %>paid<% } %>">
              <td><%= order._id %></td>
              <td><%= order.createdAt.toDateString() %></td>
              <td>$<%= order.totalPrice %></td>
              <td><% if (order.isComplete) { %>Delivered<% } else { %>Processing<% } %></td>
              <td class="actions">
                <!-- Payment url -->
                <% if (order.paid === false) { %>
                  <a href="/pay/?order=<%= order._id %>&amount=<%= order.totalPrice %>">Pay</a>
                <% } %>
                
                <!-- View order -->
                <a href="/orders/<%= order._id %>">View</a>
                
                <!-- Cancel order button -->
                <% if (order.paid === false) { %>
                  <form method="POST" action="/orders/<%= order._id %>?_method=DELETE">
                    <button>Cancel Order</button>
                  </form>
                <% } %>
              </td>
            </tr>       
          <% }) %>
        </tbody>
      </table>
    <% }  else { %>
      <span style="display: block; text-align: center; color: red; font-weight: bold;">No orders available!</span>
    <% } %>
  </div>
</section>
      
<%- include('../partials/layout_bottom') -%>
